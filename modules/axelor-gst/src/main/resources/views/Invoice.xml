<?xml version="1.0" encoding="UTF-8" standalone="yes"?>
<object-views xmlns="http://axelor.com/xml/ns/object-views" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
  xsi:schemaLocation="http://axelor.com/xml/ns/object-views http://axelor.com/xml/ns/object-views/object-views_5.0.xsd">

  <grid name="invoice-grid" title="invoice List" model="com.axelor.gst.db.Invoice">
    <field name="status" />
    <field name="reference"></field>
    <field name="dateT"></field>
    <field name="priority"></field>
    <field name="isUseInvocieAddressAsShipping"></field>
    <field name="netAmount"></field>
    <field name="netIgst"></field>
    <field name="netCsgt"></field>
    <field name="netSgst"></field>
    <field name="grossAmount"></field>
  </grid>

  <form name="invoice-form" title="Invoice" cols="2" model="com.axelor.gst.db.Invoice"
    onNew="current-date-on-new,action-defalut-company-select,action-check-selected-products,action-group-for-default-value-select-after-party-select" onSave="action-invoice-sequence-get">

    <toolbar>
      <button name="reportButton" title="Print" showTitle="false" showIf="id"
        onClick="action-report-invoice-print-invoice" icon="fa-print" />
    </toolbar>

    <panel name="statusPanel" title="Status">
      <field name="status" showTitle="false" colSpan="12" widget="NavSelect" />
    </panel>

    <panel sidebar="true" title="Status Change" showTitle="false">
      <button name="statusDraft" title="Draft" hideIf="status == 'Draft' || status == 'Paid'"
        onClick="action-attr-for-draft-status-change" />
      <button name="statusValidate" title="Validated"
        hideIf="status == 'Cancelled' || status == 'Paid' || status == 'Validated'" onClick="action-attr-for-status-validate-change" />
      <button name="statusPaid" title="Paid"
        hideIf="status == 'Draft' || status == 'Cancelled' || status == 'Paid'" onClick="action-attr-for-status-paid-change" />
      <button name="statusCancelled" title="Cancelled" hideIf="status == 'Cancelled' || status == 'Paid'"
        onClick="action-attr-for-status-cancelled-change" />
    </panel>

    <panel title="Invoice" readonlyIf="status == 'Validated' || status == 'Cancelled' || status == 'Paid'" >
      <field name="company"></field>
      <field name="reference"></field>
      <field name="dateT"></field>
      <field name="priority"></field>
      <field name="party" onChange="action-group-for-default-value-select-after-party-select"></field>
      <field name="partyContact"></field>
      <field name="invoiceAddress" ></field>
      <field name="shippingAddress"></field>
      <field name="isUseInvocieAddressAsShipping" onChange="action-group-for-default-value-select-after-party-select"></field>
      <field name="netAmount"></field>
      <field name="netIgst"></field>
      <field name="netCsgt"></field>
      <field name="netSgst"></field>
      <field name="grossAmount"></field>
      <field name="invoiceItemsList" onChange="action-invoice-net-amount-gross-amount-from-invoice-list"
        colSpan="12"></field>
    </panel>
  </form>

  <kanban name="invoice-kanban" title="Invoice Status" model="com.axelor.gst.db.Invoice"
    columnBy="status" sequenceBy="priority" limit="10" draggable="true">
    <field name="company"></field>
    <field name="reference"></field>
    <field name="dateT"></field>
    <field name="priority"></field>
    <field name="party"></field>
    <field name="partyContact"></field>
    <field name="invoiceAddress"></field>
    <field name="shippingAddress"></field>
    <field name="isUseInvocieAddressAsShipping"></field>
    <field name="netAmount"></field>
    <field name="netIgst"></field>
    <field name="netCsgt"></field>
    <field name="netSgst"></field>
    <field name="grossAmount"></field>
    <field name="invoiceItemsList" colSpan="12"></field>
    <template><![CDATA[
      <i class='fa fa-clock-o'></i><h4>{{dateT}}</h4>
    <div class="card-body">{{party.name}}</div>
    <div class="card-footer">
     <span>{{invoiceAddress.line1}}</span>
    </div>
    ]]></template>
  </kanban>

  <action-method name="action-invoice-net-amount-gross-amount-from-invoice-list">
    <call class="com.axelor.gst.web.InvoiceController" method="setAllValues" />
  </action-method>

  <action-attrs name="action-attr-for-draft-status-change">
    <attribute name="value" for="status" expr="Draft" />
  </action-attrs>

  <action-attrs name="action-attr-for-status-validate-change">
    <attribute name="value" for="status" expr="Validated" />
  </action-attrs>

  <action-attrs name="action-attr-for-status-paid-change">
    <attribute name="value" for="status" expr="Paid" />
  </action-attrs>

  <action-attrs name="action-attr-for-status-cancelled-change">
    <attribute name="value" for="status" expr="Cancelled" />
  </action-attrs>

  <action-attrs name="current-date-on-new">
    <attribute name="value" for="dateT" expr="eval: __datetime__" />
  </action-attrs>

  <action-method name="action-invoice-party-contact-gstController">
    <call class="com.axelor.gst.web.InvoiceController" method="getContactAddress" />
  </action-method>

  <action-attrs name="action-invoice-party-contact-select-primary-contact">
    <attribute name="value" for="partyContact" expr="eval: primaryContact" />
  </action-attrs>

  <action-attrs name="action-invoice-invoiceAddress-select-primary-addresss">
    <attribute name="value" for="invoiceAddress" expr="eval: defalultinvoiceAddress" />
  </action-attrs>

  <action-attrs name="action-invoice-shippingAddress-select-primary-addresss">
    <attribute name="value" for="shippingAddress" expr="eval: defalultshippingAddress" />
  </action-attrs>

  <action-group name="action-group-for-default-value-select-after-party-select">
    <action name="action-invoice-party-contact-gstController" />
    <action name="action-invoice-party-contact-select-primary-contact" />
    <action name="action-invoice-invoiceAddress-select-primary-addresss" />
    <action name="action-invoice-shippingAddress-select-primary-addresss" />
  </action-group>

  <action-method name="action-defalut-company-select">
    <call class="com.axelor.gst.web.InvoiceController" method="getDefaultCompany" />
  </action-method>

  <!-- <action-method name="action-company-address"> <call class="com.axelor.gst.web.GstController" method="getCompanyAddress" 
    /> </action-method> -->

  <action-report output="invoice-${date}-${time}" name="action-report-invoice-print-invoice"
    design="invoice.rptdesign">
    <param name="invoiceId" expr="eval: id" />
  </action-report>

  <action-method name="action-invoice-sequence-get">
    <call class="com.axelor.gst.web.InvoiceController" method="setReferenceInvoice" />
  </action-method>

  <action-attrs name="action-check-selected-products">
    <attribute name="value" for="invoiceItemsList" expr="eval: SelectProductIds" />
    <attribute name="value" for="party" expr="eval: party_name"/>
  </action-attrs>
  
   <action-method name="create-selected-invoice-on-click">
    <call class="com.axelor.gst.web.ProductController" method="getSelectedProduct" />
  </action-method>
  

</object-views>
